function executeModify(){obj=$(this),$.ajax({url:"http://comedor.undac.edu.pe:8094/novedades/update/specific/",method:"POST",data:{token:obj.data("modify")},beforeSend:function(t){capturar(obj)},success:function(t){t=JSON.parse(t),$("#formNovedades #titulo").val(t[0].title),$("#formNovedades #fecha").val(formatDate(t[0].date_pub)),$("#formNovedades #descripcion").val(t[0].description),removeCapturar(obj)},error:function(t,e,a){0===t.status?(alertify.error("No Conectado: Verifique su conexión a Internet."),removeCapturar(obj)):404==t.status?alertify.error("Error [404]: Página no encontrada."):500==t.status?alertify.error("Error [500]: Error Servidor Interno."):"timeout"===e&&alertify.error("Error de tiempo de espera... :(")}})}function executeDelete(){let t=$(this);$.ajax({url:"http://comedor.undac.edu.pe:8094/novedades/delete/specific/",method:"POST",data:{token:t.data("index")},beforeSend:function(e){capturar(t)},success:function(e){(e=JSON.parse(e)).flag?(t.parent().parent().remove(),alertify.success(e.information),getNov(!0)):alertify.success(e.information),removeCapturar(t)},error:function(e,a,o){0===e.status?(alertify.error("No Conectado: Verifique su conexión a Internet."),removeCapturar(t)):404==e.status?alertify.error("Error [404]: Página no encontrada."):500==e.status?alertify.error("Error [500]: Error Servidor Interno."):"timeout"===a&&alertify.error("Error de tiempo de espera... :(")}})}function formatDate(t){return t.substring(0,t.indexOf(" "))}function sendData(t){if($("#sendNov").html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading').attr("disabled",!0),t.preventDefault(),verifyForm($("#formNovedades"))){let e;try{e={token:obj.data("modify"),form:$("#formNovedades").serializeArray()}}catch(t){e={form:$("#formNovedades").serializeArray()}}$.ajax({url:"http://comedor.undac.edu.pe:8094/create/novedad/",method:"POST",data:e,beforeSend:function(t){console.log(t)},success:function(t){$("#sendNov").html("Guardar").attr("disabled",!1),t=JSON.parse(t),obj=null,t.errorInfo?alertify.error(t.errorT+" "+t.errorF+" "+t.errorD):(restoreForm($("#formNovedades")),getNov(!0),getNov(!1),alertify.success("Datos ingresados correctament!!!"))},error:function(t,e,a){0===t.status?(alertify.error("No Conectado: Verifique su conexión a Internet."),$("#sendNov").html("Guardar").attr("disabled",!1)):404==t.status?alertify.error("Error [404]: Página no encontrada."):500==t.status?alertify.error("Error [500]: Error Servidor Interno."):"timeout"===e&&alertify.error("Error de tiempo de espera... :(")}})}else $("#sendNov").html("Guardar").attr("disabled",!1),alertify.error("Ingrese los datos correctos porfavor!!!")}function changeState(){$.ajax({url:"http://comedor.undac.edu.pe:8094/novedades/update/state/",method:"POST",data:{token:$(this).data("state"),state:$(this).data("status")},beforeSend:function(t){console.log(t)},success:function(t){alertify.success(t),getNov(!1),getNov(!0)},error:function(){alertify.error("Surgio un Error...:(")}})}function searching(){$.ajax({url:"http://comedor.undac.edu.pe:8094/novedades/search/dato/",method:"POST",data:{search:$(this).val()},beforeSend:function(t){document.getElementById("mostrar_loadingMN").style.display="block",document.getElementById("row_flags").style.display="none"},success:function(t){console.log("SS "+t),document.getElementById("mostrar_loadingMN").style.display="none",document.getElementById("row_flags").style.display="";let e="";$.each(JSON.parse(t),function(t,a){1,e+='<tr class="'+state(a.state)+'"><td>'+t+"</td><td>"+a.title+"</td><td>"+formatDate(a.date_pub)+'</td><td class="text-justify">'+a.description+'</td><td style="width: 105px; padding-top: 10px; padding-bottom: 10px; padding-right: 0px; padding-left: 5px;"><a data-toggle="tooltip" data-state="'+encodeURIComponent(window.btoa(a.id))+'" data-status="'+encodeURIComponent(window.btoa(a.state))+'" data-placement="top" title="'+stateLeyend(a.state)+'" style="margin-right:5px" class="state btn '+stateBtn(a.state)+' btn-sm" href="#"><i style="color:#fff" class="fas fa-power-off"></i></a><a data-toggle="tooltip" data-placement="top" data-modify="'+encodeURIComponent(window.btoa(a.id))+'" title="modificar" style="margin-right:5px" class="modifydata modify'+i+' btn btn-primary btn-sm" href="#" ><i style="color:#fff" class="fas fa-edit"></i></a><a  data-toggle="tooltip" data-index="'+encodeURIComponent(window.btoa(a.id))+'" data-placement="top" title="eliminar" style="margin-right:5px" class="delete btn btn-danger btn-sm" href="#"><i style="color:#fff" class="fas fa-trash-alt"></i></a></td></tr>'}),$("#row_flags").html(e)},error:function(){alertify.error("Surgio un Error...:(")}})}function getNov(t){let e=t?"http://comedor.undac.edu.pe:8094/novedades/dato/state/":"http://comedor.undac.edu.pe:8094/novedades/dato/todo/";$.ajax({url:e,method:"POST",beforeSend:function(t){console.log(t),document.getElementById("mostrar_loadingN").style.display="block",document.getElementById("timeline-target").style.display="none",document.getElementById("mostrar_loadingMN").style.display="block",document.getElementById("row_flags").style.display="none"},success:function(e){if(document.getElementById("mostrar_loadingN").style.display="none",document.getElementById("timeline-target").style.display="block",document.getElementById("mostrar_loadingMN").style.display="none",document.getElementById("row_flags").style.display="",t){let t="";$.each(JSON.parse(e),function(e,a){t+="<li class="+format(e)+'><div class="timeline-badge primary"><a><i class="fas fa-clock" data-toggle="tooltip" data-placement="top" title="11 hours ago via Twitter" id=""></i></a></div><div class="timeline-panel"><article class="list-group-item"><div class="fondocollapse" style=""><header class="filter-header p-2" ><a href="#" data-toggle="collapse" data-target="#collapse'+e+'"><i class="icon-action fa fa-chevron-down text-white"></i><h4 class="title text-white">'+a.title+'</h4></a></header><h6 class="text-white p-2" style="margin: 0px;">fecha: '+formatDate(a.date_pub)+'</h6></div><div class="filter-content collapse px-3" id="collapse'+e+'"><p class="text-justify">'+a.description+'</p></div></article><div class="timeline-footer"><a class="pull-right" data-toggle="collapse" data-target="#collapse'+e+'">Ver más...</a></div></div></li>'}),$("#timeline-target").html(t+'<li class="clearfix" style="float: none;"></li>')}else{let t="";cont=0,$.each(JSON.parse(e),function(e,a){cont+=1,t+='<tr class="'+state(a.state)+'"><td>'+e+"</td><td>"+a.title+"</td><td>"+formatDate(a.date_pub)+'</td><td class="text-justify">'+a.description+'</td><td style="width: 105px; padding-top: 10px; padding-bottom: 10px; padding-right: 0px; padding-left: 5px;"><a data-toggle="tooltip" data-state="'+encodeURIComponent(window.btoa(a.id))+'" data-status="'+encodeURIComponent(window.btoa(a.state))+'" data-placement="top" title="'+stateLeyend(a.state)+'" style="margin-right:5px" class="state btn '+stateBtn(a.state)+' btn-sm" href="#"><i style="color:#fff" class="fas fa-power-off"></i></a><a data-toggle="tooltip" data-placement="top" data-modify="'+encodeURIComponent(window.btoa(a.id))+'" title="modificar" style="margin-right:5px" class="modifydata btn btn-primary btn-sm" href="#" id="modify'+cont+'"><i style="color:#fff" class="fas fa-edit"></i></a><a  data-toggle="tooltip" data-index="'+encodeURIComponent(window.btoa(a.id))+'" data-placement="top" title="eliminar" style="margin-right:5px" class="delete btn btn-danger btn-sm" href="#"><i style="color:#fff" class="fas fa-trash-alt"></i></a></td></tr>'}),$("#row_flags").html(t)}},error:function(){alertify.error("Surgio un Error...:(")}})}function format(t){return t%2==0?"":"timeline-inverted"}function state(t){return t?"":"table-danger"}function stateBtn(t){return t?"btn-success":"btn-warning"}function stateLeyend(t){return t?"Descactivar":"Activar"}function restoreForm(t){$(":input",t).each(function(){var t=this.type,e=this.tagName.toLowerCase();"text"==t||"password"==t||"date"==t||"textarea"==e?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==e&&(this.selectedIndex=-1)})}function verifyForm(t){let e;return $(":input",t).each(function(){var t=this.type,a=this.tagName.toLowerCase();let o=$(this);"text"!=t&&"password"!=t&&"date"!=t&&"textarea"!=a&&"select"!=a&&"checkbox"!=t&&"radio"!=t||(o.val()?(o.removeClass("is-invalid"),e=!0):(o.addClass("is-invalid"),e=!1))}),e}function capturar(t){t.html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>'),t.css({cursor:"not-allowed"}),t.removeClass("modify")}function removeCapturar(t){t.html('<i style="color:#fff" class="fas fa-edit"></i>'),t.css({cursor:"pointer"}),t.addClass("modify")}$(document).ready(function(){getNov(!1),$("#search").keyup(searching),$("body").on("click",".delete",executeDelete),$("body").on("click",".modifydata",executeModify),$("#sendNov").click(sendData),$("body").on("click",".state",changeState)}),$(document).ready(function(){var t=$("[rel=tooltip]");$(".cerrar").click(function(){$.ajax({url:"http://comedor.undac.edu.pe:8094/close/login/user/",method:"POST",success:function(t){setTimeout(function(){location.reload()},700)}})}),getNov(!0);var e=$(window).width();for(i=0;i<t.length;i++)the_post=$(t[i]),the_post.hasClass("invert")&&e>=767?(the_post.tooltip({placement:"left"}),the_post.css("cursor","pointer")):(the_post.tooltip({placement:"rigth"}),the_post.css("cursor","pointer"))});